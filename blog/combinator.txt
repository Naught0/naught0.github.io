3:I[276,["657","static/chunks/c465da65-0e6fb52f2b5f5a7e.js","990","static/chunks/990-66b8c49b617a67ef.js","206","static/chunks/app/blog/%5Bslug%5D/layout-0995e2dbc4ff5df0.js"],"BackButton"]
4:I[9986,[],""]
6:I[3582,[],""]
7:I[4295,["657","static/chunks/c465da65-0e6fb52f2b5f5a7e.js","990","static/chunks/990-66b8c49b617a67ef.js","206","static/chunks/app/blog/%5Bslug%5D/layout-0995e2dbc4ff5df0.js"],"ToTopButton"]
8:I[4386,["990","static/chunks/990-66b8c49b617a67ef.js","768","static/chunks/app/blog/layout-2a197bbdc1699e0d.js"],"NavLink"]
a:"$Sreact.suspense"
b:I[6677,["185","static/chunks/app/layout-4208c8b16835d27f.js"],"Randmoji"]
2:T1592,<h1>Making Combinator</h1>
<blockquote>
<p>Get an overview of what combos, infinite loops, and shenanigans are inside your Magic: The Gathering deck.</p>
</blockquote>
<p><img src="/combinator.jpeg" alt="" /></p>
<hr />
<p><a href="https://mtgcombinator.com">Combinator</a> is a tool to see what combos a Magic: The Gathering (MTG) deck contains. A combo is typically 2 or more cards which, when played together, will interact to form an often infinite loop, winning the game or putting you absurdly ahead.</p>
<p>When I began making Combinator, there was no easy way to find combos in a given deck list from any of the most popular deck-building websites. <a href="https://edhrec.com/">EDHREC</a> is great, but it wasn't exactly what I wanted. I needed a website that let me quickly discern what combinations of cards I should or could assemble while I was playing.</p>
<p>I also <strong>suck</strong> at MTG, so I definitely wanted to include the steps for executing some of the more elaborate combos.</p>
<h2>Assembling the Wombo Combo</h2>
<p>The first thing I needed was a way to determine which MTG cards result in infinite combos when played together.</p>
<p>Luckily, as with most things, someone has already solved that problem for me. <a href="https://commanderspellbook.com/">Commander Spellbook</a> contains tens of thousands of MTG combos submitted by the community. They previously shipped their entire database of combos as part of their frontend bundle in a JSON blob. I loaded this blob into pandas to do the card-crunching.</p>
<p>The logic for finding combos looked something like this:</p>
<pre><code class="language-py">def find_matches(data: list[dict], to_match: set[str]):
    &quot;&quot;&quot;Finds combos in a given decklist based on card names&quot;&quot;&quot;
    db = pd.DataFrame(data)
    return {
        &quot;combos&quot;: db[
            db[&quot;c&quot;].apply(lambda x: set(x).issubset(to_match))
        ].to_dict(&quot;records&quot;)
    }
</code></pre>
<p>This checks the entire database of combos against the cards in the supplied deck.</p>
<p>Et voila, I now have all combinations of cards which occur in the database that are also present in our deck. This operation isn't exactly efficient, but it works reasonably well for a DB which contains 30,000+ combos when checked against 60+ card decks.</p>
<h3>The Great Changening</h3>
<p>Sometime around the beginning of 2024 Commander Spellbook revamped their site. They no longer provided their entire database so freely (a boon to page load times I'm sure!), so I had to start using their newly created API instead.</p>
<p>The latest version of Combinator sends a list of cards to the Commander Spellbook API and parses the results to get roughly the same output as before.</p>
<pre><code class="language-py">@router.post(&quot;/combo&quot;, response_model=Results)
def combo_search(data: ComboSearchPayload):
    return requests.get(
        &quot;https://backend.commanderspellbook.com/find-my-combos&quot;,
        json=data.model_dump(mode=&quot;json&quot;),
    ).json()[&quot;results&quot;]
</code></pre>
<p>And it isn't any faster than when we did the calculations ourselves! Oh well.</p>
<h2>Stack Summary</h2>
<p>The site has evolved over time, but generally I'm using python for the backend and React for the frontend.</p>
<p><strong>Backend</strong>: Flask (later FastAPI), Pandas</p>
<p><strong>Frontend</strong>: React (originally <a href="https://create-react-app.dev/">CRA</a> but moved to <a href="https://vitejs.dev/">Vite</a>), Bulma CSS (later, a combo of Bulma + Tailwind)</p>
<h2>Hosting</h2>
<p>I originally hosted the site entirely on Google Cloud Run. This meant that the python app was serving the React frontend only after a container cold start, which wasn't ideal. I eventually moved the frontend to Cloudflare Pages which gets cached and instantly served for free. The python API is still hosted on Google Cloud Run.</p>
<h2>A Brief Tour</h2>
<p>You can search for your <a href="https://moxfield.com">Moxfield</a> username, filter your decks, and click on any to get a list of combos it contains. You can also search with a link to a deck from Moxfield, <a href="https://archidekt.com">Archidekt</a> or <a href="https://www.mtggoldfish.com/">MTG Goldfish</a>.</p>
<p><img src="/combinator-user-search.png" alt="" /></p>
<p>Once you've selected a deck, the required cards for the combo are on the left, the effects of the combo on the right. You can click the combo to see a detailed list of steps and prerequisites.</p>
<video controls>
  <source src="/combinator.mp4" type="video/mp4">
</video>
<p>Click the &quot;Add 1&quot; tab to see combos that could be added to your list with the addition of a single card.</p>
<p><img src="/combinator-add-one.png" alt="" /></p>
<p>Finally, need to quickly find which cards say &quot;infect&quot; in your deck? You can search the titles and text of cards in your deck too.</p>
<p><img src="/combinator-search.png" alt="" /></p>
<h2>Conclusion</h2>
<p>My friends and I use this site almost every time we play MTG, which is extremely gratifying. I am always iterating on the UI, and I usually have a dozen ideas bouncing around at once. Eventually, I may forgo the python API (which costs me a whopping $0.05/mo from Google) and use Cloudflare Workers for completely free hosting.</p>
<p>See the live site at <a href="https://mtgcombinator.com">mtgcombinator.com</a></p>
<p><a href="https://github.com/naught0/combinator">Check out the source on Github</a></p>
5:["slug","combinator","d"]
9:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z0:["oMIYwbJHY3vpl94gg96hK",[[["",{"children":["blog",{"children":[["slug","combinator","d"],{"children":["__PAGE__?{\"slug\":\"combinator\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","combinator","d"],{"children":["__PAGE__",{},[["$L1",["$","article",null,{"children":[["$","div",null,{"dangerouslySetInnerHTML":{"__html":"$2"}}],["$","hr",null,{}],["$","span",null,{"className":"inline-flex flex-wrap gap-2","children":["$","span",null,{"className":"inline-flex flex-wrap gap-2","children":[["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"python"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"react"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"hosting"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"cloudflare"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"google cloud"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"docker"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"mtg"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap","children":"combinator"}]]}]}]]}]],null],null]},[["$","div",null,{"className":"flex w-full flex-col items-center justify-start gap-6","children":[["$","div",null,{"className":"prose lg:prose-lg dark:prose-invert max-w-[95vw] pb-24 md:max-w-screen-sm lg:max-w-screen-md","children":[["$","div",null,{"className":"py-6","children":["$","$L3",null,{}]}],["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$5","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]}],["$","$L7",null,{}]]}],null],null]},[["$","div",null,{"className":"flex min-h-screen flex-col bg-background","children":[["$","nav",null,{"className":"flex w-full flex-row justify-between gap-3 border-b-2 border-b-slate-300 bg-black px-6 py-3","children":[["$","div",null,{"className":"flex flex-row justify-start gap-6","children":[["$","$L8",null,{"href":"/","children":"/home"}],["$","$L8",null,{"href":"/blog","children":"/blog"}]]}],["$","div",null,{"className":"flex flex-row items-center justify-end gap-3","children":["$","a",null,{"href":"https://github.com/naught0","target":"_blank","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 496 512","className":"text-2xl","children":["$undefined",[["$","path","0",{"d":"$9","children":[]}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}],"className":"text-3xl transition-all hover:scale-105 hover:opacity-100 sm:text-4xl"}]}]]}],["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]}],null],null]},[["$","html",null,{"lang":"en","children":[["$","head",null,{}],["$","body",null,{"className":"dark min-h-screen bg-black font-sans antialiased __variable_aaf875 __variable_1e1a75 __variable_2c91d1","children":[["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}],["$","div",null,{"className":"flex w-full flex-col items-center gap-6 border-t-2 border-t-slate-300 bg-black py-24 text-sm sm:text-base lg:py-36","children":[["$","p",null,{"children":["made by"," ",["$","a",null,{"href":"https://github.com/naught0","className":"vertical transition-colors hover:text-gray-400 underline","children":"james"}]," ","with"," ",["$","$a",null,{"children":["$","$Lb",null,{}]}]]}],["$","p",null,{"children":["$","a",null,{"href":"https://github.com/naught0/naught0.github.io","className":"vertical transition-colors hover:text-gray-400 underline","children":"source"}]}]]}]]}]]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/bea1e588786c6d8c.css","precedence":"next","crossOrigin":"$undefined"}]],"$Lc"]]]]
c:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Making the Combinator-inator"}],["$","meta","3",{"name":"description","content":"A behind-the-scenes look at my Magic: The Gathering website created to quickly visualize infinite combos in any deck."}],["$","link","4",{"rel":"author","href":"https://jamese.dev"}],["$","meta","5",{"name":"author","content":"Jamese E"}],["$","link","6",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","meta","7",{"name":"next-size-adjust"}]]
1:null
