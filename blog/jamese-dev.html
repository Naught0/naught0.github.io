<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/naught0.github.io/_next/static/media/86fdec36ddd9097e-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/naught0.github.io/_next/static/media/c4c7b0ec92b72e30-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/naught0.github.io/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/naught0.github.io/_next/static/css/0316ac806f40901b.css" data-precedence="next"/><link rel="stylesheet" href="/naught0.github.io/_next/static/css/0a03caec4d8a54f0.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/naught0.github.io/_next/static/chunks/webpack-e13a6ecf18974a65.js"/><script src="/naught0.github.io/_next/static/chunks/e6e143be-4fdfc2b62d100867.js" async=""></script><script src="/naught0.github.io/_next/static/chunks/660-09e0f1fca71643fd.js" async=""></script><script src="/naught0.github.io/_next/static/chunks/main-app-6fdb0465a3862343.js" async=""></script><script src="/naught0.github.io/_next/static/chunks/990-66b8c49b617a67ef.js" async=""></script><script src="/naught0.github.io/_next/static/chunks/app/blog/%5Bslug%5D/layout-be74bf23fd31626b.js" async=""></script><script src="/naught0.github.io/_next/static/chunks/app/blog/layout-2a197bbdc1699e0d.js" async=""></script><script src="/naught0.github.io/_next/static/chunks/app/layout-13176a760fca1eae.js" async=""></script><meta name="theme-color" content="black"/><title>Creating a Static Site Using Next.js 14 &amp; Github Pages</title><link rel="author" href="https://jamese.dev"/><meta name="author" content="Jamese E"/><meta name="keywords" content="blog, portfolio, jamese, jamese.dev, naught, naught0, programming, coding, webdev, python, typescript, javascript, developer"/><meta property="og:title" content="Creating a Static Site Using Next.js 14 &amp; Github Pages"/><meta property="og:image" content="https://jamese.dev/jamese-dev.webp"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Creating a Static Site Using Next.js 14 &amp; Github Pages"/><meta name="twitter:image" content="https://jamese.dev/jamese-dev.webp"/><link rel="icon" href="/naught0.github.io/icon.png?fc94df769769e509" type="image/png" sizes="398x398"/><meta name="next-size-adjust"/><script src="/naught0.github.io/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="dark min-h-screen bg-black font-sans antialiased __variable_9ef080 __variable_9f0c7e __variable_d803a4"><div class="flex min-h-screen flex-col bg-background"><nav class="flex w-full flex-row justify-between gap-3 border-b-2 border-b-slate-300 bg-black px-6 py-3"><div class="flex flex-row justify-start gap-6"><a class="transition-all hover:scale-105 hover:opacity-100 font-display inline-flex items-center gap-1 text-base font-black sm:text-xl" href="/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"></path></svg>/</a><a class="transition-all hover:scale-105 hover:opacity-100 font-display inline-flex items-center gap-1 text-base font-black sm:text-xl" href="/blog">/blog</a></div><div class="flex flex-row items-center justify-end gap-3"><a href="https://github.com/naught0" target="_blank" class="text-3xl transition-all hover:scale-105 hover:opacity-100 sm:text-4xl"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="text-xl sm:text-2xl" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></nav><div class="flex w-full flex-col items-center justify-start gap-6"><div class="prose lg:prose-lg dark:prose-invert max-w-[95vw] pb-24 pt-12 md:max-w-screen-sm lg:max-w-screen-md"><article><div><h1 id="creating-a-static-site-using-nextjs-14--github-pages">Creating a Static Site Using Next.js 14 &#x26; Github Pages</h1>
<p><img src="/jamese-dev.webp" alt=""></p>
<hr>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#configuring-next">Configuring Next</a></li>
<li><a href="#optimizing-images">Optimizing Images</a>
<ul>
<li><a href="#using-sharp">Using sharp</a></li>
</ul>
</li>
<li><a href="#transforming-markdown">Transforming markdown</a></li>
<li><a href="#building--deploying">Building &#x26; Deploying</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2 id="configuring-next">Configuring Next</h2>
<p>I found an excellent guide specific to hosting static Next.js apps on Github pages from <a href="https://github.com/gregrickaby" rel="noopener noreferrer" target="_blank">@gregrickaby</a> which you can find <a href="https://github.com/gregrickaby/nextjs-github-pages" rel="noopener noreferrer" target="_blank">here</a>.</p>
<p>All I really needed was this <code>next.config.js</code> (slightly modified from the guide):</p>
<pre><code class="hljs language-js"><span class="hljs-comment">/** <span class="hljs-doctag">@type</span> {<span class="hljs-type">import('next').NextConfig</span>} */</span>
<span class="hljs-keyword">const</span> nextConfig = {
  <span class="hljs-attr">output</span>: <span class="hljs-string">"export"</span>,
  <span class="hljs-attr">basePath</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">"development"</span> ? <span class="hljs-string">""</span> : <span class="hljs-string">"/naught0.github.io"</span>,
  <span class="hljs-attr">images</span>: { <span class="hljs-attr">unoptimized</span>: <span class="hljs-literal">true</span> },
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<p>The <code>basePath</code> needs only apply when hosted on Github pages, so I get rid of it in dev so that <code>&#x3C;img /></code>s work locally.</p>
<h2 id="optimizing-images">Optimizing Images</h2>
<p>When <code>output</code> is <code>"export"</code>, Next will not optimize images automatically. I have a number of images in the repo that vary in size, quality, and format. I need to resize and compress these into <code>.webp</code>s because that's what our lord and savior Lighthouse™️  demands.</p>
<p>I initially thought to use ImageMagick for this task, but I discovered <a href="https://sharp.pixelplumbing.com/" rel="noopener noreferrer" target="_blank">sharp</a> which promised to be faster with a pleasant API.</p>
<h3 id="using-sharp">Using sharp</h3>
<p>I store the original images in <code>images/</code>. I need to process them, then place them in <code>public/</code> where they can be easily served later.</p>
<p>A trimmed down version of the script looks like this:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> sharp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"sharp"</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);

<span class="hljs-keyword">const</span> inputDir = path.<span class="hljs-title function_">join</span>(<span class="hljs-string">"images"</span>);
<span class="hljs-keyword">const</span> outputDir = path.<span class="hljs-title function_">join</span>(<span class="hljs-string">"public"</span>);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processImage</span>(<span class="hljs-params">filePath</span>) {
  <span class="hljs-keyword">const</span> fileName = path.<span class="hljs-title function_">basename</span>(filePath);
  <span class="hljs-keyword">const</span> outputFilePath = path.<span class="hljs-title function_">join</span>(
    outputDir,
    <span class="hljs-string">`<span class="hljs-subst">${fileName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>]}</span>.webp`</span>
  );

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// Basically set a maxWidth of 1280 &#x26; convert to webp</span>
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">sharp</span>(filePath)
      .<span class="hljs-title function_">resize</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1280</span>, <span class="hljs-attr">withoutEnlargement</span>: <span class="hljs-literal">true</span> }) 
      .<span class="hljs-title function_">webp</span>({ <span class="hljs-attr">force</span>: <span class="hljs-literal">true</span> })
      .<span class="hljs-title function_">toFile</span>(outputFilePath);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Processed <span class="hljs-subst">${fileName}</span>`</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error processing <span class="hljs-subst">${fileName}</span>:`</span>, error);
  }
}
<span class="hljs-comment">// For each jpeg, png file => processImage(path), etc.</span>
</code></pre>
<p>I run this as the first step of my build process. You can find the <a href="https://github.com/Naught0/naught0.github.io/blob/master/scripts/process-images.js" rel="noopener noreferrer" target="_blank">full script here</a>.</p>
<h2 id="transforming-markdown">Transforming markdown</h2>
<p>Next has good support for <a href="https://nextjs.org/docs/app/building-your-application/configuring/mdx" rel="noopener noreferrer" target="_blank">MDX</a> pages, but it's not exactly what I'm looking for.</p>
<p>Instead, I define the metadata (title, description, tags, etc.) for each blog post in <code>data/blogs.ts</code>.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">blogs</span>: <span class="hljs-title class_">Array</span>&#x3C;<span class="hljs-title class_">BlogPost</span>> = [
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">"Creating a Static Site Using Next.js 14 &#x26; Github Pages"</span>,
    <span class="hljs-attr">slug</span>: <span class="hljs-string">"jamese-dev"</span>,
    <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-06-16"</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">imageUrl</span>: <span class="hljs-string">"/jamese-dev.webp"</span>,
    <span class="hljs-attr">tags</span>: [
      <span class="hljs-string">"next.js"</span>,
      <span class="hljs-string">"github pages"</span>,
      <span class="hljs-string">"SSG"</span>,
      <span class="hljs-string">"image optimization"</span>,
      <span class="hljs-string">"sharp"</span>,
      <span class="hljs-string">"markdown"</span>,
      <span class="hljs-string">"blog"</span>,
    ],
  },
  <span class="hljs-comment">// ...</span>
];
</code></pre>
<p>Writing this in plain typescript makes it easy to consume throughout the rest of the app. I can render a list of my blog posts, like at <a href="/blog">https://jamese.dev/blog</a>. Most importantly, I'm able to iterate over these values to generate my static pages with Next using <a href="https://nextjs.org/docs/app/api-reference/functions/generate-static-params" rel="noopener noreferrer" target="_blank"><code>generateStaticParams</code></a>.</p>
<p>I write each blog post using plain ole markdown (egads!) in <code>data/posts/[slug].md</code>. I use <a href="https://github.com/remarkjs/remark" rel="noopener noreferrer" target="_blank">remark</a> and <a href="https://github.com/rehypejs/rehype" rel="noopener noreferrer" target="_blank">rehype</a> from "unified.js" with a bunch of plugins to transform my posts from markdown into HTML. The plugins are responsible for everything from creating the table of contents to adding syntax highlighting to code snippets. My pipeline looks like this:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">markdownToHtml</span>(<span class="hljs-params">markdown: Compatible</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">unified</span>()
      .<span class="hljs-title function_">use</span>(remarkParse)
      .<span class="hljs-title function_">use</span>(remarkToc)
      .<span class="hljs-title function_">use</span>(remarkGfm)
      .<span class="hljs-title function_">use</span>(remarkRehype)
      .<span class="hljs-title function_">use</span>(rehypeSlug)
      .<span class="hljs-title function_">use</span>(rehypeHighlight)
      .<span class="hljs-title function_">use</span>(rehypeExternalLinks, {
        <span class="hljs-attr">rel</span>: [<span class="hljs-string">"noopener"</span>, <span class="hljs-string">"noreferrer"</span>],
        <span class="hljs-attr">target</span>: <span class="hljs-string">"_blank"</span>,
      })
      .<span class="hljs-title function_">use</span>(rehypeStringify)
      .<span class="hljs-title function_">process</span>(markdown),
  );
}
</code></pre>
<p>I only need to pass the output of this function to <code>dangerouslySetInnerHTML</code> on an element. I don't have to do any sanitization because I don't plan on pwning myself – at least not anytime soon. You can see how this and all blog posts are rendered <a href="https://github.com/Naught0/naught0.github.io/blob/master/app/blog/%5Bslug%5D/page.tsx" rel="noopener noreferrer" target="_blank">here</a>.</p>
<h2 id="building--deploying">Building &#x26; Deploying</h2>
<p>To deploy to Github Pages, I use the <a href="https://github.com/tschaub/gh-pages" rel="noopener noreferrer" target="_blank"><code>gh-pages</code></a> utility. I could set up a Github action to do the same thing upon merge to main, but I like this way since I'm just committing straight to main anyhow.</p>
<p>My <code>package.json</code> scripts look like this:</p>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"next dev"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm process-images &#x26;&#x26; next build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"next start"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"next lint"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"process-images"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./scripts/process-images.js"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"predeploy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"next build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"deploy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gh-pages --nojekyll --cname www.jamese.dev -d out"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>The process is straightforward. I just run <code>pnpm run deploy</code> and:</p>
<ol>
<li>Images are converted to <code>.webp</code> and placed in <code>public/</code></li>
<li>The Next site is built and statically exported to <code>out/</code></li>
<li><code>gh-pages</code> does its thing to push the build artifacts in <code>out/</code> to Github
<ul>
<li>It also creates the <a href="https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/" rel="noopener noreferrer" target="_blank"><code>.nojekyll</code></a> and <code>CNAME</code> files for me</li>
</ul>
</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>That's it! There are some minor quirks, but building a completely static site with Next.js and hosting it via Github pages is pretty easy – and free :)</p></div><hr/><span class="inline-flex flex-wrap gap-2"><span class="inline-flex flex-wrap gap-2"><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">next.js</div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">github pages</div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">SSG</div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">image optimization</div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">sharp</div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">markdown</div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap">blog</div></span></span></article></div><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-slate-300 hover:bg-primary-foreground hover:text-primary h-10 w-10 fixed bottom-12 right-12 bg-black/30"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up"><path d="m5 12 7-7 7 7"></path><path d="M12 19V5"></path></svg></button></div></div><div class="flex w-full flex-col items-center gap-6 border-t-2 border-t-slate-300 bg-black py-24 text-sm sm:text-base lg:py-36"><p>made by<!-- --> <a href="https://github.com/naught0" class="vertical transition-colors hover:text-gray-400 underline">james</a> <!-- -->with<!-- --> <!--$-->😅<!--/$--></p><p><a href="https://github.com/naught0/naught0.github.io" class="vertical transition-colors hover:text-gray-400 underline">source</a></p></div><script src="/naught0.github.io/_next/static/chunks/webpack-e13a6ecf18974a65.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/naught0.github.io/_next/static/media/86fdec36ddd9097e-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/naught0.github.io/_next/static/media/c4c7b0ec92b72e30-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/naught0.github.io/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/naught0.github.io/_next/static/css/0316ac806f40901b.css\",\"style\"]\n5:HL[\"/naught0.github.io/_next/static/css/0a03caec4d8a54f0.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"6:I[5921,[],\"\"]\n9:I[9986,[],\"\"]\nb:I[3582,[],\"\"]\nc:I[1218,[\"990\",\"static/chunks/990-66b8c49b617a67ef.js\",\"206\",\"static/chunks/app/blog/%5Bslug%5D/layout-be74bf23fd31626b.js\"],\"ToTopButton\"]\nd:I[4386,[\"990\",\"static/chunks/990-66b8c49b617a67ef.js\",\"768\",\"static/chunks/app/blog/layout-2a197bbdc1699e0d.js\"],\"NavLink\"]\nf:\"$Sreact.suspense\"\n10:I[6677,[\"185\",\"static/chunks/app/layout-13176a760fca1eae.js\"],\"Randmoji\"]\n12:I[3765,[],\"\"]\na:[\"slug\",\"jamese-dev\",\"d\"]\ne:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z13:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/naught0.github.io/_next/static/css/0316ac806f40901b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"buildId\":\"g4GD9M1BwXKZFeZLYpgED\",\"assetPrefix\":\"/naught0.github.io\",\"initialCanonicalUrl\":\"/blog/jamese-dev\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"jamese-dev\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"jamese-dev\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"jamese-dev\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L7\",\"$L8\"],null],null]},[[\"$\",\"div\",null,{\"className\":\"flex w-full flex-col items-center justify-start gap-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose lg:prose-lg dark:prose-invert max-w-[95vw] pb-24 pt-12 md:max-w-screen-sm lg:max-w-screen-md\",\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$a\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/naught0.github.io/_next/static/css/0a03caec4d8a54f0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}]}],[\"$\",\"$Lc\",null,{}]]}],null],null]},[[\"$\",\"div\",null,{\"className\":\"flex min-h-screen flex-col bg-background\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"flex w-full flex-row justify-between gap-3 border-b-2 border-b-slate-300 bg-black px-6 py-3\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-row justify-start gap-6\",\"children\":[[\"$\",\"$Ld\",null,{\"href\":\"/\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 16 16\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"/\"]}],[\"$\",\"$Ld\",null,{\"href\":\"/blog\",\"children\":\"/blog\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex flex-row items-center justify-end gap-3\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/naught0\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"className\":\"text-xl sm:text-2xl\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$e\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"className\":\"text-3xl transition-all hover:scale-105 hover:opacity-100 sm:text-4xl\"}]}]]}],[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]}],null],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"dark min-h-screen bg-black font-sans antialiased __variable_9ef080 __variable_9f0c7e __variable_d803a4\",\"children\":[[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}],[\"$\",\"div\",null,{\"className\":\"flex w-full flex-col items-center gap-6 border-t-2 border-t-slate-300 bg-black py-24 text-sm sm:text-base lg:py-36\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"made by\",\" \",[\"$\",\"a\",null,{\"href\":\"https://github.com/naught0\",\"className\":\"vertical transition-colors hover:text-gray-400 underline\",\"children\":\"james\"}],\" \",\"with\",\" \",[\"$\",\"$f\",null,{\"children\":[\"$\",\"$L10\",null,{}]}]]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/naught0/naught0.github.io\",\"className\":\"vertical transition-colors hover:text-gray-400 underline\",\"children\":\"source\"}]}]]}]]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"name\":\"theme-color\",\"content\":\"black\"}],[\"$\",\"meta\",\"2\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"3\",{\"children\":\"Creating a Static Site Using Next.js 14 \u0026 Github Pages\"}],[\"$\",\"link\",\"4\",{\"rel\":\"author\",\"href\":\"https://jamese.dev\"}],[\"$\",\"meta\",\"5\",{\"name\":\"author\",\"content\":\"Jamese E\"}],[\"$\",\"meta\",\"6\",{\"name\":\"keywords\",\"content\":\"blog, portfolio, jamese, jamese.dev, naught, naught0, programming, coding, webdev, python, typescript, javascript, developer\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:title\",\"content\":\"Creating a Static Site Using Next.js 14 \u0026 Github Pages\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image\",\"content\":\"https://jamese.dev/jamese-dev.webp\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:title\",\"content\":\"Creating a Static Site Using Next.js 14 \u0026 Github Pages\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:image\",\"content\":\"https://jamese.dev/jamese-dev.webp\"}],[\"$\",\"link\",\"12\",{\"rel\":\"icon\",\"href\":\"/naught0.github.io/icon.png?fc94df769769e509\",\"type\":\"image/png\",\"sizes\":\"398x398\"}],[\"$\",\"meta\",\"13\",{\"name\":\"next-size-adjust\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"14:T320b,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"creating-a-static-site-using-nextjs-14--github-pages\"\u003eCreating a Static Site Using Next.js 14 \u0026#x26; Github Pages\u003c/h1\u003e\n\u003cp\u003e\u003cimg src=\"/jamese-dev.webp\" alt=\"\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"contents\"\u003eContents\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#configuring-next\"\u003eConfiguring Next\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#optimizing-images\"\u003eOptimizing Images\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#using-sharp\"\u003eUsing sharp\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#transforming-markdown\"\u003eTransforming markdown\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#building--deploying\"\u003eBuilding \u0026#x26; Deploying\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conclusion\"\u003eConclusion\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"configuring-next\"\u003eConfiguring Next\u003c/h2\u003e\n\u003cp\u003eI found an excellent guide specific to hosting static Next.js apps on Github pages from \u003ca href=\"https://github.com/gregrickaby\" rel=\"noopener noreferrer\" target=\"_blank\"\u003e@gregrickaby\u003c/a\u003e which you can find \u003ca href=\"https://github.com/gregrickaby/nextjs-github-pages\" rel=\"noopener noreferrer\" target=\"_blank\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAll I really needed was this \u003ccode\u003enext.config.js\u003c/code\u003e (slightly modified from the guide):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e/** \u003cspan class=\"hljs-doctag\"\u003e@type\u003c/span\u003e {\u003cspan class=\"hljs-type\"\u003eimport('next').NextConfig\u003c/span\u003e} */\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nextConfig = {\n  \u003cspan class=\"hljs-attr\"\u003eoutput\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"export\"\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003ebasePath\u003c/span\u003e: process.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eNODE_ENV\u003c/span\u003e === \u003cspan class=\"hljs-string\"\u003e\"development\"\u003c/span\u003e ? \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\"/naught0.github.io\"\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003eimages\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eunoptimized\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e },\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e nextConfig;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003ebasePath\u003c/code\u003e needs only apply when hosted on Github pages, so I get rid of it in dev so that \u003ccode\u003e\u0026#x3C;img /\u003e\u003c/code\u003es work locally.\u003c/p\u003e\n\u003ch2 id=\"optimizing-images\"\u003eOptimizing Images\u003c/h2\u003e\n\u003cp\u003eWhen \u003ccode\u003eoutput\u003c/code\u003e is \u003ccode\u003e\"export\"\u003c/code\u003e, Next will not optimize images automatically. I have a number of images in the repo that vary in size, quality, and format. I need to resize and compress these into \u003ccode\u003e.webp\u003c/code\u003es because that's what our lord and savior Lighthouse™️  demands.\u003c/p\u003e\n\u003cp\u003eI initially thought to use ImageMagick for this task, but I discovered \u003ca href=\"https://sharp.pixelplumbing.com/\" rel=\"noopener noreferrer\" target=\"_blank\"\u003esharp\u003c/a\u003e which promised to be faster with a pleasant API.\u003c/p\u003e\n\u003ch3 id=\"using-sharp\"\u003eUsing sharp\u003c/h3\u003e\n\u003cp\u003eI store the original images in \u003ccode\u003eimages/\u003c/code\u003e. I need to process them, then place them in \u003ccode\u003epublic/\u003c/code\u003e where they can be easily served later.\u003c/p\u003e\n\u003cp\u003eA trimmed down version of the script looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e sharp = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"sharp\"\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e fs = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"fs\"\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e path = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"path\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e inputDir = path.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"images\"\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e outputDir = path.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"public\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eprocessImage\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003efilePath\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e fileName = path.\u003cspan class=\"hljs-title function_\"\u003ebasename\u003c/span\u003e(filePath);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e outputFilePath = path.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(\n    outputDir,\n    \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${fileName.split(\u003cspan class=\"hljs-string\"\u003e\".\"\u003c/span\u003e)[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]}\u003c/span\u003e.webp`\u003c/span\u003e\n  );\n\n  \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Basically set a maxWidth of 1280 \u0026#x26; convert to webp\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esharp\u003c/span\u003e(filePath)\n      .\u003cspan class=\"hljs-title function_\"\u003eresize\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003ewidth\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1280\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ewithoutEnlargement\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e }) \n      .\u003cspan class=\"hljs-title function_\"\u003ewebp\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003eforce\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e })\n      .\u003cspan class=\"hljs-title function_\"\u003etoFile\u003c/span\u003e(outputFilePath);\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`Processed \u003cspan class=\"hljs-subst\"\u003e${fileName}\u003c/span\u003e`\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`Error processing \u003cspan class=\"hljs-subst\"\u003e${fileName}\u003c/span\u003e:`\u003c/span\u003e, error);\n  }\n}\n\u003cspan class=\"hljs-comment\"\u003e// For each jpeg, png file =\u003e processImage(path), etc.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI run this as the first step of my build process. You can find the \u003ca href=\"https://github.com/Naught0/naught0.github.io/blob/master/scripts/process-images.js\" rel=\"noopener noreferrer\" target=\"_blank\"\u003efull script here\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"transforming-markdown\"\u003eTransforming markdown\u003c/h2\u003e\n\u003cp\u003eNext has good support for \u003ca href=\"https://nextjs.org/docs/app/building-your-application/configuring/mdx\" rel=\"noopener noreferrer\" target=\"_blank\"\u003eMDX\u003c/a\u003e pages, but it's not exactly what I'm looking for.\u003c/p\u003e\n\u003cp\u003eInstead, I define the metadata (title, description, tags, etc.) for each blog post in \u003ccode\u003edata/blogs.ts\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eblogs\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eArray\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eBlogPost\u003c/span\u003e\u003e = [\n  {\n    \u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Creating a Static Site Using Next.js 14 \u0026#x26; Github Pages\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eslug\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"jamese-dev\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ecreatedAt\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2024-06-16\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eimageUrl\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"/jamese-dev.webp\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003etags\u003c/span\u003e: [\n      \u003cspan class=\"hljs-string\"\u003e\"next.js\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"github pages\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"SSG\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"image optimization\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"sharp\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"markdown\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"blog\"\u003c/span\u003e,\n    ],\n  },\n  \u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n];\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWriting this in plain typescript makes it easy to consume throughout the rest of the app. I can render a list of my blog posts, like at \u003ca href=\"/blog\"\u003ehttps://jamese.dev/blog\u003c/a\u003e. Most importantly, I'm able to iterate over these values to generate my static pages with Next using \u003ca href=\"https://nextjs.org/docs/app/api-reference/functions/generate-static-params\" rel=\"noopener noreferrer\" target=\"_blank\"\u003e\u003ccode\u003egenerateStaticParams\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eI write each blog post using plain ole markdown (egads!) in \u003ccode\u003edata/posts/[slug].md\u003c/code\u003e. I use \u003ca href=\"https://github.com/remarkjs/remark\" rel=\"noopener noreferrer\" target=\"_blank\"\u003eremark\u003c/a\u003e and \u003ca href=\"https://github.com/rehypejs/rehype\" rel=\"noopener noreferrer\" target=\"_blank\"\u003erehype\u003c/a\u003e from \"unified.js\" with a bunch of plugins to transform my posts from markdown into HTML. The plugins are responsible for everything from creating the table of contents to adding syntax highlighting to code snippets. My pipeline looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003emarkdownToHtml\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003emarkdown: Compatible\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eunified\u003c/span\u003e()\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(remarkParse)\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(remarkToc)\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(remarkGfm)\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(remarkRehype)\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(rehypeSlug)\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(rehypeHighlight)\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(rehypeExternalLinks, {\n        \u003cspan class=\"hljs-attr\"\u003erel\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\"noopener\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"noreferrer\"\u003c/span\u003e],\n        \u003cspan class=\"hljs-attr\"\u003etarget\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"_blank\"\u003c/span\u003e,\n      })\n      .\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(rehypeStringify)\n      .\u003cspan class=\"hljs-title function_\"\u003eprocess\u003c/span\u003e(markdown),\n  );\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI only need to pass the output of this function to \u003ccode\u003edangerouslySetInnerHTML\u003c/code\u003e on an element. I don't have to do any sanitization because I don't plan on pwning myself – at least not anytime soon. You can see how this and all blog posts are rendered \u003ca href=\"https://github.com/Naught0/naught0.github.io/blob/master/app/blog/%5Bslug%5D/page.tsx\" rel=\"noopener noreferrer\" target=\"_blank\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"building--deploying\"\u003eBuilding \u0026#x26; Deploying\u003c/h2\u003e\n\u003cp\u003eTo deploy to Github Pages, I use the \u003ca href=\"https://github.com/tschaub/gh-pages\" rel=\"noopener noreferrer\" target=\"_blank\"\u003e\u003ccode\u003egh-pages\u003c/code\u003e\u003c/a\u003e utility. I could set up a Github action to do the same thing upon merge to main, but I like this way since I'm just committing straight to main anyhow.\u003c/p\u003e\n\u003cp\u003eMy \u003ccode\u003epackage.json\u003c/code\u003e scripts look like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e\u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"dev\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"next dev\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"pnpm process-images \u0026#x26;\u0026#x26; next build\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"start\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"next start\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"lint\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"next lint\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"process-images\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"./scripts/process-images.js\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"predeploy\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"next build\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"gh-pages --nojekyll --cname www.jamese.dev -d out\"\u003c/span\u003e\n  \u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe process is straightforward. I just run \u003ccode\u003epnpm run deploy\u003c/code\u003e and:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eImages are converted to \u003ccode\u003e.webp\u003c/code\u003e and placed in \u003ccode\u003epublic/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eThe Next site is built and statically exported to \u003ccode\u003eout/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egh-pages\u003c/code\u003e does its thing to push the build artifacts in \u003ccode\u003eout/\u003c/code\u003e to Github\n\u003cul\u003e\n\u003cli\u003eIt also creates the \u003ca href=\"https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/\" rel=\"noopener noreferrer\" target=\"_blank\"\u003e\u003ccode\u003e.nojekyll\u003c/code\u003e\u003c/a\u003e and \u003ccode\u003eCNAME\u003c/code\u003e files for me\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThat's it! There are some minor quirks, but building a completely static site with Next.js and hosting it via Github pages is pretty easy – and free :)\u003c/p\u003e"])</script><script>self.__next_f.push([1,"8:[\"$\",\"article\",null,{\"children\":[[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$14\"}}],[\"$\",\"hr\",null,{}],[\"$\",\"span\",null,{\"className\":\"inline-flex flex-wrap gap-2\",\"children\":[\"$\",\"span\",null,{\"className\":\"inline-flex flex-wrap gap-2\",\"children\":[[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"next.js\"}],[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"github pages\"}],[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"SSG\"}],[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"image optimization\"}],[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"sharp\"}],[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"markdown\"}],[\"$\",\"div\",null,{\"className\":\"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 text-nowrap\",\"children\":\"blog\"}]]}]}]]}]\n"])</script></body></html>